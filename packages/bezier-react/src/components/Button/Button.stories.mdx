import {
  useState,
} from 'react'
import {
  Canvas,
  Meta,
  Story,
} from '@storybook/addon-docs'
import base from 'paths.macro'
import {
  getTitle,
} from 'Utils/storyUtils'
import {
  Avatar,
} from 'Components/Avatars/Avatar'
import {
  Button,
  ButtonSize,
  ButtonColorVariant,
  ButtonStyleVariant,
} from 'Components/Button'
import {
  ListItem,
} from 'Components/ListItem'
import {
  Overlay,
  OverlayPosition,
} from 'Components/Overlay'
import {
  SectionLabel,
} from 'Components/SectionLabel'
import {
  StackItem,
  HStack,
  VStack,
} from 'Components/Stack'
import {
  StatusType,
} from 'Components/Status'
import {
  Text,
} from 'Components/Text'
import {
  styled,
  Typography,
} from 'Foundation'

<Meta
  title={getTitle(base)}
  parameters={{
    viewMode: 'docs',
  }}
/>

# Button

## Overview

버튼은 클릭을 통해 사용자에게 액션을 제공하는 컴포넌트입니다.

버튼은 크게 4가지 사이즈로 나뉩니다. 그 중 M이 가장 보편적이며, 공간 절약을 위해 S가 쓰입니다. List나 Input 등 액션이 필요할 때는 XS도 사용할 수 있습니다. 가입, 초대 UX 등 굉장히 강조해야 할 버튼의 경우, L, XL 사이즈를 사용할 수 있습니다.

<Canvas>
  <Story name="Button:Overview.CTA">
    <HStack justify="center" spacing={6}>
      <StackItem>
        <Button
          disabled
          text="Cancel"
          colorVariant={ButtonColorVariant.MonochromeLight}
          styleVariant={ButtonStyleVariant.Secondary}
        />
      </StackItem>
      <StackItem>
        <Button
          leftContent="open-in-new"
          text="Open link"
          colorVariant={ButtonColorVariant.Blue}
          styleVariant={ButtonStyleVariant.Secondary}
        />
      </StackItem>
      <StackItem>
        <Button
          leftContent="check"
          text="Publish"
          colorVariant={ButtonColorVariant.Green}
          styleVariant={ButtonStyleVariant.Primary}
        />
      </StackItem>
    </HStack>
  </Story>
</Canvas>

<Canvas>
  <Story name="Button:Overview.Floating">
    <HStack justify="center">
      <StackItem>
        <Button
          leftContent="chevron-down"
          text="New messages"
          colorVariant={ButtonColorVariant.Cobalt}
          styleVariant={ButtonStyleVariant.Floating}
        />
      </StackItem>
    </HStack>
  </Story>
</Canvas>

## Usage

### Recipe: Call to action

- 한 화면 내에서 CTA 버튼은 가능한 한, 가장 중요한 버튼 1개만 primary로 지정합니다. 후순위로 colored button을 같이 넣어야 할 경우에는 secondary로 넣습니다. 그 외에는 secondary, tetiary button을 조합하여 넣습니다.
- 버튼 사이의 간격은 0 또는 6으로 합니다.

<Canvas>
  <Story name="Button:Usage.CTA">
    <HStack justify="center" spacing={6}>
      <StackItem>
        <Button
          text="취소"
          colorVariant={ButtonColorVariant.MonochromeLight}
          styleVariant={ButtonStyleVariant.Secondary}
        />
      </StackItem>
      <StackItem>
        <Button
          leftContent="play"
          text="퍼블리시"
          colorVariant={ButtonColorVariant.Green}
          styleVariant={ButtonStyleVariant.Primary}
        />
      </StackItem>
    </HStack>
  </Story>
</Canvas>


<Canvas>
  <Story name="Button:Usage.CTA2">
    <HStack justify="center" spacing={6}>
      <StackItem>
        <Button
          text="임시 저장 삭제"
          disabled
          colorVariant={ButtonColorVariant.MonochromeLight}
          styleVariant={ButtonStyleVariant.Secondary}
        />
      </StackItem>
      <StackItem>
        <Button
          text="임시 저장"
          colorVariant={ButtonColorVariant.Blue}
          styleVariant={ButtonStyleVariant.Secondary}
        />
      </StackItem>
      <StackItem>
        <Button
          leftContent="play"
          text="퍼블리시"
          colorVariant={ButtonColorVariant.Green}
          styleVariant={ButtonStyleVariant.Primary}
        />
      </StackItem>
      <StackItem>
        <Button
          leftContent="cancel"
          colorVariant={ButtonColorVariant.MonochromeLight}
          styleVariant={ButtonStyleVariant.Tertiary}
        />
      </StackItem>
    </HStack>
  </Story>
</Canvas>

### Recipe: Web links

- 보통의 경우, tertiary button을 적절한 icon과 함께 사용합니다.

<Canvas>
  <Story name="Button:Usage.WebLinks">
    <HStack justify="center" spacing={6}>
      <StackItem>
        <Button
          leftContent="open-in-new"
          text="See guide"
          rightContent="arrow-right"
          styleVariant={ButtonStyleVariant.Tertiary}
        />
      </StackItem>
      <StackItem>
        <Button
          text="See guide"
          rightContent="arrow-right"
          styleVariant={ButtonStyleVariant.Tertiary}
        />
      </StackItem>
      <StackItem>
        <Button
          leftContent="open-in-new"
          text="See guide"
          styleVariant={ButtonStyleVariant.Tertiary}
        />
      </StackItem>
    </HStack>
  </Story>
</Canvas>

### Recipe: Composite Usage

- XS 크기의 버튼은 ListItem, SectionLabel 등 다른 컴포넌트에 함께 사용될 수 있습니다. 컴포넌트 좌우측에서 액션으로 사용됩니다.

export const Card = styled.div`
  width: 360px;
  padding: 6px;
  ${({ foundation }) => foundation?.elevation.ev3()}
  ${({ foundation }) => foundation?.rounding.round12}
`

<Story name="Button:Usage.Composite">
  <HStack justify="center">
    <StackItem>
      <Card>
        <VStack align="stretch">
          <StackItem>
            <SectionLabel
              leftContent={{ icon: 'people' }}
              content="태그 ∙ 2"
              rightContent={(
                <Button
                  size={ButtonSize.XS}
                  leftContent="chevron-down"
                  styleVariant={ButtonStyleVariant.Tertiary}
                  colorVariant={ButtonColorVariant.MonochromeLight}
                />
              )}
            />
          </StackItem>
          <StackItem>
            <ListItem
              leftIcon="tag"
              content="KR/Product"
              rightContent={(
                <HStack>
                  <StackItem>
                    <Button
                      size={ButtonSize.XS}
                      leftContent="edit"
                      styleVariant={ButtonStyleVariant.Tertiary}
                      colorVariant={ButtonColorVariant.MonochromeLight}
                    />
                  </StackItem>
                  <StackItem>
                    <Button
                      size={ButtonSize.XS}
                      leftContent="cancel"
                      styleVariant={ButtonStyleVariant.Tertiary}
                      colorVariant={ButtonColorVariant.MonochromeLight}
                    />
                  </StackItem>
                </HStack>
              )}
            />
          </StackItem>
          <StackItem>
            <ListItem
              leftIcon="tag"
              content="KR/Design"
              rightContent={(
                <HStack>
                  <StackItem>
                    <Button
                      size={ButtonSize.XS}
                      leftContent="edit"
                      styleVariant={ButtonStyleVariant.Tertiary}
                      colorVariant={ButtonColorVariant.MonochromeLight}
                    />
                  </StackItem>
                  <StackItem>
                    <Button
                      size={ButtonSize.XS}
                      leftContent="cancel"
                      styleVariant={ButtonStyleVariant.Tertiary}
                      colorVariant={ButtonColorVariant.MonochromeLight}
                    />
                  </StackItem>
                </HStack>
              )}
            />
          </StackItem>
        </VStack>
      </Card>
    </StackItem>
  </HStack>
</Story>

### Recipe: Button with various contents

- 기본적으로 `leftContent`, `rightContent` prop에 icon name에 해당하는 string을 지정하여 좌우측에 아이콘이 들어가는 형태를 표현합니다.

<Canvas>
  <Story name="Butotn:Usage.VariousContents.Composite">
    <HStack justify="center">
      <StackItem>
        <Button
          leftContent="play"
          text="퍼블리시"
          rightContent="arrow-right"
          colorVariant={ButtonColorVariant.Green}
        />
      </StackItem>
    </HStack>
  </Story>
</Canvas>

- 아이콘만 들어가는 버튼의 경우, `leftContent` prop만 사용합니다.

<Canvas>
  <Story name="Butotn:Usage.VariousContents.IconOnly">
    <HStack justify="center">
      <StackItem>
        <Button
          leftContent="plus"
          colorVariant={ButtonColorVariant.MonochromeLight}
          styleVariant={ButtonStyleVariant.Secondary}
        />
      </StackItem>
    </HStack>
  </Story>
</Canvas>

- 아이콘 이외에 커스텀 컴포넌트가 들어가야 하는 상황에는, `leftContent`, `rightContent` prop에 `JSX.Element` 값을 지정할 수 있습니다.

export const AlertBadge = styled.div`
  display: flex;
  justify-content: center;
  align-items: center;
  width: 20px;
  height: 20px;
  background-color: var(--bgtxt-red-dark);
  border-radius: 50%;
`

<Canvas>
  <Story name="Butotn:Usage.VariousContents.Custom">
    <HStack justify="center">
      <StackItem>
        <Button
          leftContent={(
            <Avatar
              name="channel"
              avatarUrl="https://cf.channel.io/thumb/200x200/pub-file/1/606d87d059a6093594c0/ch-symbol-filled-smiley-bg.png"
              status={StatusType.Online}
            />
          )}
          text="New messages"
          rightContent={(
            <AlertBadge>
              <Text typo={Typography.Size13} color="txt-white-normal">1</Text>
            </AlertBadge>
          )}
          colorVariant={ButtonColorVariant.Red}
          styleVariant={ButtonStyleVariant.Floating}
        />
      </StackItem>
    </HStack>
  </Story>
</Canvas>

### Recipe: Button with asynchronous actions

- 비동기적인 액션을 처리하는 경우, 액션이 처리중인 상태를 사용자에게 노출해야 하고, 액션이 처리중이라면 버튼을 비활성화하여 액션이 중복 처리되는 것을 막는 것이 보통의 경우입니다. `loading`, `disabled` prop을 통해 이 usecase를 구현할 수 있습니다.

```tsx
const AsyncActionButton = () => {
  const [isFetching, setFetching] = useState(false)
  const handleClick = () => {
    setFetching(true)
    setTimeout(() => {
      setFetching(false)
    }, 1000)
  }
  return (
    <Button
      leftContent="play"
      text="Click Me!"
      colorVariant={ButtonColorVariant.Cobalt}
      styleVariant={ButtonStyleVariant.Primary}
      loading={isFetching}
      disabled={isFetching}
      onClick={handleClick}
    />
  )
}
```

export const AsyncActionButton = () => {
  const [isFetching, setFetching] = useState(false)
  const handleClick = () => {
    setFetching(true)
    setTimeout(() => {
      setFetching(false)
    }, 1000)
  }
  return (
    <Button
      leftContent="play"
      text="Click Me!"
      colorVariant={ButtonColorVariant.Cobalt}
      styleVariant={ButtonStyleVariant.Primary}
      loading={isFetching}
      disabled={isFetching}
      onClick={handleClick}
    />
  )
}

<Canvas>
  <Story
    name="Button:Usage.Async"
  >
    <HStack justify="center">
      <StackItem>
        <AsyncActionButton />
      </StackItem>
    </HStack>
  </Story>
</Canvas>

### Recipe: Button with dropdown

- 버튼을 눌러 dropdown, select 등 별도의 UI를 노출하는 경우, 해당 UI가 노출된 상태에서는 버튼이 "눌린 상태"를 유지하는 것이 자연스럽습니다.
- `active` prop을 통해 버튼이 "눌린 상태" 임을 표현할 수 있습니다.

```tsx
const OpenDropdownButton = () => {
  const [isOpen, setIsOpen] = useState(false)

  return (
    <div>
      <Button
        text="Select"
        rightContent="triangle-down"
        active={isOpen}
        colorVariant={ButtonColorVariant.MonochromeLight}
        styleVariant={ButtonStyleVariant.Tertiary}
        onClick={() => setIsOpen(true)}
      />

      { ... }
    </div>
  )
}
```

export const Dropdown = styled.div`
  width: 200px;
  padding: 6px;
  ${({ foundation }) => foundation?.elevation.ev2()}
  ${({ foundation }) => foundation?.rounding.round8}
`

export const OpenDropdownButton = () => {
  const [isOpen, setIsOpen] = useState(false)
  const [target, setTarget] = useState(null)
  const [container, setContainer] = useState(null)
  return (
    <div style={{ position: 'relative' }} ref={setContainer}>
      <Button
        ref={setTarget}
        text="Select"
        rightContent="triangle-down"
        active={isOpen}
        colorVariant={ButtonColorVariant.MonochromeLight}
        styleVariant={ButtonStyleVariant.Tertiary}
        onClick={() => setIsOpen(true)}
      />
      <Overlay
        show={isOpen}
        onHide={() => setIsOpen(false)}
        target={target}
        container={container}
        position={OverlayPosition.BottomLeft}
        marginY={6}
      >
        <Dropdown>
          <Text typo={Typography.Size13} marginLeft={6}>Dropdown content</Text>
        </Dropdown>
      </Overlay>
    </div>
  )
}

<Canvas>
  <Story name="Button:Usage.Dropdown">
    <HStack justify="center">
      <StackItem>
        <OpenDropdownButton />
      </StackItem>
    </HStack>
  </Story>
</Canvas>

## Variants

### Color Variants

- `ButtonColorVariant` enum을 통해 정의되며, `colorVariant` prop으로 지정할 수 있습니다.

<Story name="Button:Variants.Color">
  <VStack spacing={16} align="start">
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>Blue</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="plus" text="Invite" colorVariant={ButtonColorVariant.Blue} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>Red</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="trash" text="Remove" colorVariant={ButtonColorVariant.Red} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>Green</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="play" text="Publish" colorVariant={ButtonColorVariant.Green} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>Cobalt</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="videocam" text="Join" colorVariant={ButtonColorVariant.Cobalt} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>Orange</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="heart-filled" text="Warn" colorVariant={ButtonColorVariant.Orange} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>Pink</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="videocam" text="Pink" colorVariant={ButtonColorVariant.Pink} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>Purple</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="videocam" text="Purple" colorVariant={ButtonColorVariant.Purple} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>Monochrome Dark</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="lightning" text="Dark" colorVariant={ButtonColorVariant.MonochromeDark} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>Monochrome Light</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="lightning" text="Light alpha" colorVariant={ButtonColorVariant.MonochromeLight} />
        </StackItem>
      </HStack>
    </StackItem>
  </VStack>
</Story>

### Style Variants

- `ButtonStyleVariant` enum을 통해 정의되며, `styleVariant` prop으로 지정할 수 있습니다.

<Story name="Button:Variants.Style">
  <VStack spacing={16} align="start">
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>Primary</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="plus" rightContent="chevron-right" text="Invite" colorVariant={ButtonColorVariant.Blue} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>Secondary</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="plus" rightContent="chevron-right" text="Invite" styleVariant={ButtonStyleVariant.Secondary} colorVariant={ButtonColorVariant.Blue} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>Tertiary</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="plus" rightContent="chevron-right" text="Invite" styleVariant={ButtonStyleVariant.Tertiary} colorVariant={ButtonColorVariant.Blue} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>Floating</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="plus" rightContent="chevron-right" text="Invite" styleVariant={ButtonStyleVariant.Floating} colorVariant={ButtonColorVariant.Blue} />
        </StackItem>
      </HStack>
    </StackItem>
  </VStack>
</Story>

### Size

- `ButtonSize` enum을 통해 정의되며, `size` prop으로 지정할 수 있습니다.

<Story name="Button:Variants.Size">
  <VStack spacing={16} align="start">
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>XS (20px)</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="calendar" rightContent="triangle-down" text="Join" size={ButtonSize.XS} colorVariant={ButtonColorVariant.Blue} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>S (24px)</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="calendar" rightContent="triangle-down" text="Join" size={ButtonSize.S} colorVariant={ButtonColorVariant.Blue} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>M (36px)</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="calendar" rightContent="triangle-down" text="Join" size={ButtonSize.M} colorVariant={ButtonColorVariant.Blue} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>L (44px)</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="calendar" rightContent="triangle-down" text="Join" size={ButtonSize.L} colorVariant={ButtonColorVariant.Blue} />
        </StackItem>
      </HStack>
    </StackItem>
    <StackItem>
      <HStack spacing={24} align="center">
        <StackItem size={80}>
          <Text typo={Typography.Size13}>XL (54px)</Text>
        </StackItem>
        <StackItem>
          <Button leftContent="calendar" rightContent="triangle-down" text="Join" size={ButtonSize.XL} colorVariant={ButtonColorVariant.Blue} />
        </StackItem>
      </HStack>
    </StackItem>
  </VStack>
</Story>

## API

- `ButtonProps`는 `BezierComponentProps`를 지원합니다.

<details>
<summary><h3>ButtonSize</h3></summary>

```ts
enum ButtonSize {
  XS,
  S,
  M,
  L,
  XL,
}
```
</details>

<details>
<summary><h3>ButtonColorVariant</h3></summary>

```ts
enum ButtonColorVariant {
  Blue,
  Red,
  Green,
  Cobalt,
  Orange,
  Pink,
  Purple,
  MonochromeLight,
  MonochromeDark,

  // @deprecated
  Monochrome,
}
```
</details>

<details>
<summary><h3>ButtonStyleVariant</h3></summary>

```ts
enum ButtonStyleVariant {
  Primary,
  Secondary,
  Tertiary,
  Floating,
}
```
</details>

<details>
<summary><h3>ButtonProps</h3></summary>

```ts
interface ButtonProps {
  /**
   * `type` attribute of typical HTML button.
   *
   * You may want to set `type` to `submit` to the button
   * which is used as a submit button in `<form>` component.
   *
   * @default 'button'
   */
  type?: HTMLButtonElement['type']

  /**
   * The text content in the button.
   *
   * Do not pass `text` prop if it is an icon-only button.
   */
  text?: string

  /**
   * The content displayed at left of the text content in the button.
   */
  leftContent?: IconName | React.ReactNode

  /**
   * The content displayed at right of the text content in the button.
   */
  rightContent?: IconName | React.ReactNode

  /**
   * If `loading` is true, spinner will be shown, replacing the content.
   *
   * @default false
   */
  loading?: boolean

  /**
   * If `active` is true, the button will be styled as if it is hovered.
   *
   * You may want to use this prop for a button which opens dropdown, etc.
   *
   * @default false
   */
  active?: boolean

  /**
   * Whether the button is disabled, and unable to interact.
   *
   * @default false
   */
  disabled?: boolean

  /**
   * The style variant.
   *
   * @default ButtonStyleVariant.Primary
   */
  styleVariant?: ButtonStyleVariant

  /**
   * The color variant.
   *
   * @default ButtonColorVariant.Blue
   */
  colorVariant?: ButtonColorVariant

  /**
   * The size variant.
   *
   * @default ButtonSize.M
   */
  size?: ButtonSize

  /**
   * The handler to be executed when the button is clicked.
   */
  onClick?: React.MouseEventHandler

  /**
   * The handler to be executed when the mouse enters the button.
   */
  onMouseEnter?: React.MouseEventHandler

  /**
   * The handler to be executed when the mouse leaves the button.
   */
  onMouseLeave?: React.MouseEventHandler

  /**
   * The handler to be executed when the button is unfocused.
   */
  onBlur?: React.MouseEventHandler
}
```
</details>

## Version

- Available since v0.3.28
